# .windsurfrules ‚Äî egos-lab Monorepo
# VERSION 1.0.0 ‚Äî Initialized 2026-02-13
# Sacred Code: 000.111.369.963.1618
# Heritage: carteira-livre governance v4.0

---
project: "egos-lab"
type: "monorepo-lab"
parent: "carteira-livre"
---

## üìã SSOT (Single Source of Truth)

> **5 arquivos governam tudo. N√£o crie novos docs ‚Äî atualize estes.**

| Arquivo | Prop√≥sito | MAX linhas |
|---------|-----------|------------|
| `AGENTS.md` | Config do projeto, stack, commands | 200 |
| `TASKS.md` | Todas as tasks (SSOT) | 300 |
| `.windsurfrules` | Regras do agente (este arquivo) | 300 |
| `docs/STANDARDS.md` | **The Golden Rules (Identity/Tech/Arch)** | 200 |
| `.guarani/PREFERENCES.md` | Padr√µes de c√≥digo | 150 |
| `.guarani/IDENTITY.md` | Identidade do agente | 100 |

## ‚ö° PRIME DIRECTIVE

> **NEVER write manual logic if a Tool (MCP) exists.**
> **NEVER build UI without Google Stitch design first.**
> **NEVER mix egos-lab code with carteira-livre.**

## üéØ MANDAMENTOS

1. **Cada ideia = um app** em `apps/`. NUNCA misturar.
2. **Shared code** vai em `packages/shared/`. Zero duplica√ß√£o.
3. **API-first** ‚Äî tudo deve ser callable por agentes (MCP-ready).
4. **Cost tracking** ‚Äî todo uso de AI logado com custo em USD.
5. **Stitch-first** ‚Äî UI designs V√ÉO para Google Stitch antes do c√≥digo.
6. **Idea ingestion** ‚Äî rodar `npm run scan:ideas` antes de commits.

## üé® DESIGN STANDARD: GOOGLE STITCH

```
WORKFLOW OBRIGAT√ìRIO:
1. Escrever prompt de design ‚Üí docs/stitch/[feature].md
2. Gerar design no Google Stitch ‚Üí exportar mockup
3. Implementar c√≥digo -> matching pixel-perfect com design
4. NUNCA construir dashboard/UI direto sem Stitch mockup
```

Quando agente precisar criar UI:
- Gere o PROMPT para Stitch, n√£o o c√≥digo
- Salve em `docs/stitch/[feature].md`
- Diga ao usu√°rio: "Design pronto para Stitch, gere l√° e volte com o resultado"

## üì• IDEA INGESTION

```
SOURCE: /home/enio/Downloads/compiladochats/
SCRIPT: scripts/scan_ideas.ts
TRIGGER: pre-commit hook OU manual (npm run scan:ideas)

REGRAS:
- S√≥ processa .md (ChatGPT-*, Gemini-*, Claude-*)
- Ignora: .pdf, .zip, .csv, .xlsx, .jnlp, .txt
- Hash de cada arquivo para evitar duplicatas
- Classifica: business_idea | personal | noise
- Copia business_ideas ‚Üí docs/plans/
```

## üîó CROSS-REPO RULES

| Repo | O que FAZ | O que N√ÉO FAZ |
|------|-----------|----------------|
| `carteira-livre` | SaaS em produ√ß√£o | Experimentos |
| `egos-lab` | Prot√≥tipos MVP | Deploy para produ√ß√£o |
| `EGOSv5` | Arquivado | NADA (legacy) |

## üìä METRICS

| M√©trica | Target |
|---------|--------|
| Max file size | 400 LOC |
| API cost/month | < $10 |
| Test coverage | > 60% (apps) |
| Idea scan freq | Every commit |

## üß† AI MEMORY SYNC

Para garantir que agentes (Antigravity + Windsurf) compartilhem contexto:

1. **AGENTS.md** √© lido por AMBOS os agentes no startup
2. **TASKS.md** √© a SSOT de progresso ‚Äî sempre atualizar
3. **Commits descritivos** ‚Äî cada commit explica o "porqu√™" para o outro agente
4. **Handoffs** ‚Äî usar `docs/_current_handoffs/` quando trocar de agente
5. **compiladochats** ‚Äî scanear antes de cada sess√£o nova

## üîë ENV VARS

```env
OPENROUTER_API_KEY=   # AI analysis (Gemini via OpenRouter)
# NOT needed for MVP: SUPABASE_URL, SUPABASE_KEY (Phase 2+)
```
## üõ°Ô∏è SECURITY & CODE QUALITY

- **Recursion:** Always set `MAX_DEPTH` (limit ~50) for recursive functions.
- **API Keys:** NEVER hardcode. Use `.env`. Validate restrictions (IP/Package). Ref: `docs/KEY_MANAGEMENT.md`.
- **Review:** All Commits must pass `scripts/security_scan.ts`.
